{"ast":null,"code":"import axios from 'axios';\nimport AuthService from './auth.service';\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000/api';\nclass ClienteService {\n  constructor() {\n    this.refreshAuth();\n  }\n  refreshAuth() {\n    const user = AuthService.getCurrentUser();\n    this.token = user === null || user === void 0 ? void 0 : user.accessToken;\n    this.authHeader = this.token ? {\n      Authorization: `Bearer ${this.token}`\n    } : {};\n    console.log(\"ClienteService - Token disponível:\", this.token ? \"Sim\" : \"Não\");\n  }\n  async getClienteProfile() {\n    this.refreshAuth(); // Sempre atualiza o token\n\n    console.log(\"Buscando perfil do cliente em:\", `${API_URL}/cliente/perfil`);\n    try {\n      const response = await axios.get(`${API_URL}/cliente/perfil`, {\n        headers: this.authHeader,\n        timeout: 5000 // 5 segundos timeout\n      });\n      if (response.data) {\n        console.log(\"Resposta do servidor:\", JSON.stringify(response.data));\n      }\n      return response;\n    } catch (error) {\n      this.logErrorDetails(error);\n      throw error;\n    }\n  }\n  logErrorDetails(error) {\n    console.error(\"Erro ao comunicar com a API:\", error.message);\n    if (error.response) {\n      // O servidor respondeu com status fora do intervalo 2xx\n      console.error(\"Status:\", error.response.status);\n      console.error(\"Dados:\", error.response.data);\n      console.error(\"Headers:\", error.response.headers);\n    } else if (error.request) {\n      // A requisição foi feita mas não houve resposta\n      console.error(\"Sem resposta do servidor. Requisição:\", error.request);\n    } else {\n      // Algo aconteceu na configuração da requisição\n      console.error(\"Erro de configuração:\", error.message);\n    }\n    console.error(\"Config completa:\", error.config);\n  }\n\n  // Atualizar perfil do cliente\n  async updateClienteProfile(clienteData) {\n    this.refreshAuth(); // Garante que o token está atualizado\n    console.log(\"Atualizando perfil, dados:\", clienteData);\n    return axios.put(`${API_URL}/cliente/perfil`, clienteData, {\n      headers: this.authHeader\n    });\n  }\n\n  // Obter histórico de consultas do cliente\n  async getConsultas() {\n    this.refreshAuth(); // Garante que o token está atualizado\n    return axios.get(`${API_URL}/cliente/consultas`, {\n      headers: this.authHeader\n    });\n  }\n}\nexport default new ClienteService();","map":{"version":3,"names":["axios","AuthService","API_URL","process","env","REACT_APP_API_URL","ClienteService","constructor","refreshAuth","user","getCurrentUser","token","accessToken","authHeader","Authorization","console","log","getClienteProfile","response","get","headers","timeout","data","JSON","stringify","error","logErrorDetails","message","status","request","config","updateClienteProfile","clienteData","put","getConsultas"],"sources":["C:/Users/s0ares/clinicadentaria_ai2/client/src/services/cliente.service.js"],"sourcesContent":["import axios from 'axios';\r\nimport AuthService from './auth.service';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000/api';\r\n\r\nclass ClienteService {\r\n  constructor() {\r\n    this.refreshAuth();\r\n  }\r\n  \r\n  refreshAuth() {\r\n    const user = AuthService.getCurrentUser();\r\n    this.token = user?.accessToken;\r\n    this.authHeader = this.token \r\n      ? { Authorization: `Bearer ${this.token}` } \r\n      : {};\r\n    \r\n    console.log(\"ClienteService - Token disponível:\", this.token ? \"Sim\" : \"Não\");\r\n  }\r\n\r\n  async getClienteProfile() {\r\n    this.refreshAuth(); // Sempre atualiza o token\r\n    \r\n    console.log(\"Buscando perfil do cliente em:\", `${API_URL}/cliente/perfil`);\r\n    \r\n    try {\r\n      const response = await axios.get(`${API_URL}/cliente/perfil`, {\r\n        headers: this.authHeader,\r\n        timeout: 5000 // 5 segundos timeout\r\n      });\r\n      \r\n      if (response.data) {\r\n        console.log(\"Resposta do servidor:\", JSON.stringify(response.data));\r\n      }\r\n      \r\n      return response;\r\n    } catch (error) {\r\n      this.logErrorDetails(error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  logErrorDetails(error) {\r\n    console.error(\"Erro ao comunicar com a API:\", error.message);\r\n    \r\n    if (error.response) {\r\n      // O servidor respondeu com status fora do intervalo 2xx\r\n      console.error(\"Status:\", error.response.status);\r\n      console.error(\"Dados:\", error.response.data);\r\n      console.error(\"Headers:\", error.response.headers);\r\n    } else if (error.request) {\r\n      // A requisição foi feita mas não houve resposta\r\n      console.error(\"Sem resposta do servidor. Requisição:\", error.request);\r\n    } else {\r\n      // Algo aconteceu na configuração da requisição\r\n      console.error(\"Erro de configuração:\", error.message);\r\n    }\r\n    \r\n    console.error(\"Config completa:\", error.config);\r\n  }\r\n\r\n  // Atualizar perfil do cliente\r\n  async updateClienteProfile(clienteData) {\r\n    this.refreshAuth(); // Garante que o token está atualizado\r\n    console.log(\"Atualizando perfil, dados:\", clienteData);\r\n    return axios.put(`${API_URL}/cliente/perfil`, clienteData, {\r\n      headers: this.authHeader\r\n    });\r\n  }\r\n\r\n  // Obter histórico de consultas do cliente\r\n  async getConsultas() {\r\n    this.refreshAuth(); // Garante que o token está atualizado\r\n    return axios.get(`${API_URL}/cliente/consultas`, {\r\n      headers: this.authHeader\r\n    });\r\n  }\r\n}\r\n\r\nexport default new ClienteService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}